<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"></meta><link href="/Abacus/exigo.css" rel="stylesheet"></link></head><body><header><a href="/Abacus/"><img height="80px" src="/Abacus/Images/AbacusLight.svg" width="auto"></img></a><nav><a href="/Abacus/UserGuide">User Guide</a><a href="/Abacus/ObjectReference">Object Reference</a><a href="/Abacus/FunctionReference">Function Reference</a></nav></header><main><h1>The DataGrid Component</h1><p>The DataGrid component implements a high-performance, virtual HTML table, suitable for browsing and editing tables large and small.</p><h2>Getting Started</h2><p>First, we must construct an array of <a href="/Abacus/ObjectReference/DataGridColumn">DataGridColumn</a> objects that define both the schema and the data. DataGridColumn objects are just plain namespaces with some appropriate variables or properties. For example:</p><pre><code>      c←⎕NS¨3⍴⊂''      c.Name←'FirstName' 'LastName' 'DOB'      c.Type←'VarChar' 'VarChar' 'Date'      c.Value←(                'Johann' 'Wolfgang' 'Ludvig'                'Bach' 'Mozart' 'Beethoven'                 19991231 20010101 2250101                )</code></pre><p>Once we have a collection of column objects, we can create a new <a href="/Abacus/ObjectReference/DataGrid">DataGrid</a> object, specifying the <a href="/Abacus/ObjectReference/DataGrid/Properties/Columns">Columns</a> property: </p><pre><code>      g←A.DataGrid.New ⊂'Columns' c</code></pre><blockquote><p>NB: When setting DataGrid properties after the creation of the grid, you must set them in the Table subspace, as in <code>g.Table.ReadOnly←1</code>. This is an accident of development, and might be temporary, and these properties moved to the root of the grid. </p></blockquote><p>We can try this out with:</p><pre><code>      d←A.StartDesktopApplication A.NewDocument g</code></pre><p>The <code>Columns</code> property is the only DataGrid property that must be supplied by the programmer. All other properties have a default value.   </p><p>All of DataGridColumn properties are optional, but either the <a href="/Abacus/ObjectReference/DataGridColumn/Properties/Type">Type</a> or <a href="/Abacus/ObjectReference/DataGridColumn/Properties/Value">Value</a> property must be specified. If no types are defined, they are inferred from the values, and if no values are supplied then they default to empty columns.  If both are supplied they must be in agreement. It is good practive to explicilty define your types.</p><h2>Column Types</h2><p>The DataGrid comes with a set of built-in column types. These include:</p><h3>Char</h3><p>Char values are provided, stored, and returned as a character matrix. The <a href="MaxLength">MaxLength</a> property determines the maximum width of the matrix. Char supports autocomplete functionality via the <a href="/Abacus/ObjectReference/DataGridColumn/Properties/List">List</a> property. </p><h3>VarChar</h3><p>VarChar values are provided, stored and returned as a vector of vectors. The <a href="MaxLength">MaxLength</a> property determines the maximum length of any value. VarChar supports autocomplete functionality via the <a href="/Abacus/ObjectReference/DataGridColumn/Properties/List">List</a> property. </p><h3>Int</h3><p>Integer values are provided as a simple vector. The <a href="/Abacus/ObjectReference/DataGridColumn/Properties/FormatString">FormatString</a> property controls how the values are displayed. The default format string is 'CI20.2'</p><h3>Dec1, Dec2, Dec3</h3><p>Decimal values are provided as a simple integer vector with an implied decimal. The <a href="/Abacus/ObjectReference/DataGridColumn/Properties/FormatString">FormatString</a>property controls how the values are displayed. The default string for Dec3 is <code>F20.3</code>, and thus the value <code>6785</code> is displayed as <code>6.785</code>.     ### Float</p><p>Float values are provided as a simple vector. The <a href="/Abacus/ObjectReference/DataGridColumn/Properties/FormatString">FormatString</a> property controls how the values are displayed.</p><h3>Date</h3><p>Dates are stored as a simple vector of integers in the form of YYYYMMDD.</p><h3>CheckBox</h3><p>Checkbox values are stored as a Boolean vector.</p><h3>Select</h3><p>The select type provides a fixed list of choices, set by the <a href="/Abacus/ObjectReference/DataGridColumn/Properties/List">List</a> property.  Select columnvalues are stored as a character matrix.</p><h2>Validation</h2><p>All types are handled by the browser in a basic text input element, and conversion and validation is done in APL. Additional validation may be specifiied via the <code>OnValidate</code> property. For example, to specifiy that an integer column should only allow non-negative values, we would create the following function:</p><pre><code>     MyValidatation←{              e←⍵&lt;0              e ⍵ 'Value must be non-negative.'      } </code></pre><p>And assign it to the OnValidate property:</p><pre><code>      g.Table.OnValidate←A.FQP 'MyValidation'</code></pre><blockquote><p>Note the use of <code>A.FQP</code> which adds the fully qualified path to the event handler</p></blockquote><p>The right argument provided to the validation function is the value to be validated.</p><p>The left argument is the corresponding DataGridColumn object. The DataGridColumn in turn gives access to all columns via its DataGrid property. Thus validations can ensure things like this "the max of the sum of this column is 100." In addition, the DataGridColumn object may be used to store any application specific data needed for validation.</p><p>The result of the validate function contains the value that will actually be used to update the grid. Usually this is just <code>⍵</code> passed through. But this gives you the ability to transform the value in some way. For example, to allow the user to only enter alphabetical characters, and to ensure uppercase:</p><pre><code>      MyValidatation←{               m←⎕C ⍵               e←~∧m∊⎕A               e m 'Only the letters A..Z accepted.'       }</code></pre><p>Validation only applies to manual data entry after the grid has been created. There is no validation of the column as a whole. The DataGrid expects your DataGridColumn objects to be properly constructed.</p><h2>Custom Column Types</h2><p>In most cases the built-in column types should suffice. However, column types are fully defined by the <a href="/Abacus/ObjectReference/DataGridColumn/Properties/OnFormat">OnFormat</a>, <a href="/Abacus/ObjectReference/DataGridColumn/Properties/OnParse">OnParse</a>, and optionally, the <a href="/Abacus/ObjectReference/DataGridColumn/Properties/OnValidate">OnValidate</a> handler functions. This means that you can define new types by simply defining these functions. For example, we can make up a type named <code>RGB</code> which will be stored as a 3 item numeric vector of integers from 0 to 255 by defining:</p><pre><code>OnFormatRGB←{     {1↓,' ','ZI3'⎕FMT ⍵}¨⍵ }OnParseRGB←{     b v←⎕VFI ⍵     0=≢b:1 v''     (v≡⌊v)∧(b≡3⍴1)∧∧/(v≥0)∧v≤255:1 v''     0 0 'Value must be 3 integers from 0 to 255.' }</code></pre><h2>Events</h2><p>The grid supports a set of events. For each event there is a corresponding  property for specifying an event handler. For example, an event handler may be specified for the <a href="/Abacus/ObjectReference/DataGrid/Events/CellChange">CellChange</a> event like so:</p><pre><code>       g.OnCellChange←A.FQP 'MyHandler'</code></pre><p>The right argument provided to the event handler is an event message, the left argument is a reference to the grid,</p></main><footer></footer></body></html>
