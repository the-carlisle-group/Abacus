<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"></meta><link href="/Abacus/exigo.css" rel="stylesheet"></link></head><body><header><a href="/Abacus/"><img height="80px" src="/Abacus/Images/AbacusLight.svg" width="auto"></img></a><nav><a href="/Abacus/UserGuide">User Guide</a><a href="/Abacus/ObjectReference">Object Reference</a><a href="/Abacus/FunctionReference">Function Reference</a></nav></header><main><h1>Components</h1><p>An Abacus component is an HTMLElement, some child elements, some CSS, and some behavior. Components may be as simple as the <a href="CheckBox">CheckBox</a>, or as complex as the <a href="/Abacus/ObjectReference/DataGrid">DataGrid</a>.</p><blockquote><p>Abacus components are not Web Components. There is no shadow DOM. </p></blockquote><p>A component is implemented as a namespace. Lets's examine the code in the <code>NumberInput</code> component.</p><p>First, every component must have a <code>New</code> function:</p><pre><code> New←{     ⍺←0     d←(⍺ A.New'div')⎕NS(         'Name' ''         'Label' ''         'Value' 0         'Format' 'I10'         'OnChange' ''     )A.Default ⍵     _←d.⎕DF 'NumberInput'     d.class←'NumberInput'     g.Class←⎕THIS     l←d A.New'label'd.Label     l.for←d.Name     i←d A.New'input'     i.id←p.Name     d.Onchange←A.FQP'OnChange'     _←d InitValue d.Value     d }</code></pre><p>The left argument to <code>New</code> is an optional parent element. The right argument is an array of property names and values (similar to <code>⎕WC</code>), or a namespace. However they are supplied, the property names and values are injected into the root element of the component, <code>d</code> in this case. By inspection, we can see the properties and default values of this component. All components begin this way.</p><p>Propeteries are simple variables. There are no getter and setter functions, so sometimes initializion or refresh functions are provided. </p><p>The <code>Name</code> property uniquely identifies the component within some document node. Unlike the HTML <code>id</code> attribute, it does not need to be unique within the document as a whole. All components must have a <code>Name</code> property. This component has 3 additional properties: <code>Label</code>, <code>Value</code>, and <code>Format</code>.</p><p>The <code>NumberInput</code> component is a <code>&lt;div&gt;</code> containing a <code>&lt;label&gt;</code> and an <code>&lt;input&gt;</code>. We capture the JavaScript <code>change</code> event, and call <code>OnChange</code> back in APL: </p><pre><code>OnChange←{     d←⍵.CurrentTarget     v←Parse ⍵.Value     f←d.Format Format v     _←d SetValue Parse f     ⍵ A.Execute'OnChange' }</code></pre><p>The right argument to OnChange, provided by Abacus, inludes a wealth of information from the browser. The <code>CurrentTarget</code> is the component itself, and the <code>Value</code> property is the value from the <code>&lt;input&gt;</code> element. We defined the &lt;input&gt; element as type=text, so we convert the text into a number using <code>Parse</code>   </p><p>In addition to properites and methods, components may expose events.  The NumberInput component exposes a <a href="Change">Change</a> event, with an implied 'OnChange'  property.  After the built-in OnChange function does what it needs to do, it calls the user-supplied event handler for the change event. This function is   supplied an event message as its right argument, and the object instance as its left argument.  </p><p>The <code>Parse</code> and <code>Format</code> functions are fairly trivial:</p><pre><code>Parse←{     ⊃1⊃⎕VFI ⍵/⍨⍵∊⎕D,'.' } Format←{     ' '~⍨,⍺ ⎕FMT ⍵ }</code></pre><p>Finally, we have a <code>CSS</code> function to provide component-specific CSS:</p><pre><code>CSS←{     Rule←A.NewRule     ⍝ ************************     s←Rule'.NumberInput'     s.display←'flex'     s.flex_direction←'column'     s.gap←'.5rem'     ⍝ ************************     r←s Rule'input'     r.text_align←'right'     ⍝ ************************     A.UnNestCSS s }</code></pre></main><footer></footer></body></html>
